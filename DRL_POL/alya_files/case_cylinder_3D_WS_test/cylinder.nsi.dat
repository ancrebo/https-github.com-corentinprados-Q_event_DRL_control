$------------------------------------------------------------
PHYSICAL_PROBLEM
$------------------------------------------------------------ 
PROBLEM_DEFINITION       
  TEMPORAL_DERIVATIVES:	On  
  CONVECTIVE_TERM:    	EMAC
  VISCOUS_TERM:       	LAPLACIAN
END_PROBLEM_DEFINITION  
$------------------------------------------------------------
PROPERTIES
$   THERMODYN_PRESSURE = 759.9375
$   GAS_CONSTANT = 287.0
END_PROPERTIES  
$------------------------------------------------------------
END_PHYSICAL_PROBLEM  
$------------------------------------------------------------
NUMERICAL_TREATMENT 
  TIME_STEP:	EIGENVALUE $ comentar cuando prescribed
  ELEMENT_LENGTH: 	Minimum
  STABILIZATION:	OFF
  TIME_INTEGRATION:	RUNGE, ORDER:2
  SAFETY_FACTOR:	0.8
  STEADY_STATE_TOLER:	1e-10
  ASSEMBLY:	GPU2
  VECTOR:	ON
  NORM_OF_CONVERGENCE:	LAGGED_ALGEBRAIC_RESIDUAL
  MAXIMUM_NUMBER_OF_IT:	1
  GRAD_DIV = ON

  ALGORITHM:SEMI_IMPLICIT
      $GAMMA = 0.0
      $ROTAT = 0.0
  END_ALGORITHM

  MOMENTUM
     ALGEBRAIC_SOLVER     
				$ SOLVER:                EXPLICIT, APPROXIMATE, ORDER=0
        SOLVER:	EXPLICIT,	LUMPED
     END_ALGEBRAIC_SOLVER        
  END_MOMENTUM

  CONTINUITY 
     ALGEBRAIC_SOLVER
         SOLVER:	DEFLATED_CG, COARSE: SPARSE
         CONVERGENCE:	ITERA=1000, TOLER=1.0e-10, ADAPTATIVE, RATIO=1e-2
         OUTPUT:	CONVERGENCE
         PRECONDITIONER:	LINELET, NEVER_CHANGE
     END_ALGEBRAIC_SOLVER        
  END_CONTINUITY

  VISCOUS
    ALGEBRAIC_SOLVER
       SOLVER:               CG, COARSE: SPARSE, KRYLOV:10
       CONVERGENCE:          ITERA=500, TOLER=1.0e-10, ADAPTIVE, RATIO=1e-3
       OUTPUT:               CONVERGENCE
       PRECONDITIONER:       DIAGONAL
    END_ALGEBRAIC_SOLVER    
  END_VISCOUS
  
  DIRICHLET: MATRIX
END_NUMERICAL_TREATMENT  
$------------------------------------------------------------
OUTPUT_&_POST_PROCESS  
  $POSTPROCESS VELOC, STEPS=10
  $POSTPROCESS PRESS, STEPS=10
  $POSTPROCESS AVVEL, STEPS=10
  $POSTPROCESS AVPRE, STEPS=10
  $POSTPROCESS LAMB2, STEPS=10
  POSTPROCESS VELOC, PERIODS=0.05
  POSTPROCESS PRESS, PERIODS=0.05
  POSTPROCESS AVVEL, PERIODS=0.05
  POSTPROCESS AVPRE, PERIODS=0.05
  POSTPROCESS LAMB2, PERIODS=0.05
  BOUNDARY_SET
	FORCE
        MASS
  END_BOUNDARY_SET
  WITNESS_POINTS
	VELOX,
	VELOY,
	VELOZ,
	PRESS,
  END_WITNESS
END_OUTPUT_&_POST_PROCESS  
$------------------------------------------------------------
BOUNDARY_CONDITIONS, NON_CONSTANT

  PARAMETERS
      $INITIAL_CONDITION: CONSTANT, 
      INITIAL_CONDITION: CONSTANT, VALUES = 0.5, 0.0, 0.0 
      FIX_PRESSURE: OFF
      VARIATION = NON_CONSTANT
  END_PARAMETERS 
  INCLUDE boundary_codes.dat
END_BOUNDARY_CONDITIONS  
$------------------------------------------------------------
